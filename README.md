DataVirtualizationDemo
======================

Demo for DV version 6 by sgutierr@redhat.com

Define two variables: 
{source}: location of source code of clone https://github.com/sgutierr/DataVirtualizationDemo.git
{EAP_HOME}: location where EAP is installed.

Main content files:

1- CustomerVDB.vdb -> defines virtual database, it is generated by JBoss Developer Studio, it's a kind of WAR, you can deploy it and view inside like .zip file. Contains:
  -source/CustomerCRM.xmi -> ws -> webservice -> CustomerCRMREST
  -source/CustomerERP.xmi -> postgres -> java:jboss/datasources/DVDemoPostgres
  -source/CustomerMktg.xmi -> file -> text-connector -> java:/marketdata-file
  -view/CustomerViews.xmi

2- CustomerRESTWebSvc -> Litle WAR only provides REST API interface for demo
   URL to test: http://localhost:8080/CustomerRESTWebSvc/MyRESTApplication/customerList
   Source Code:


Installation process: 

1-  Deploy the war file that will be used as the web service resource to be accessed as a data source by Teiid

        -  copy the {source}/utils/WS//CustomerRestWebSvc.war to the {EAP_HOME}/standalone/deployments directory
            cp $SOURCE/utils/WS/CustomerRESTWebSvc.war $EAP_HOME/standalone/deployments


2- Install the Customer web service datasource to be referenced by the Teiid VDB

  run the following CLI script. if you aren't using openshift cartridge:
  
	-  cd to the ${JBOSS_HOME}/bin directory
	-  execute:  ./jboss-cli.sh --connect file={source}/utils/EAP/scripts/setup_demo.cli 
       With Openshift cartridge you must launch the script from your laptop doing port forwarding. 
        Openshift DV Cartridge:
        rhc port-forward -a jbossdv -n eseguti
        ./jboss-cli.sh -c --file=setup_demo.cli


3- Add File resource
   Copy directory from  {source}/data/teiidfiles to {EAP_HOME}
    cp -r $SOURCE/data/teiidfiles $EAP_HOME

4- Teiid Roles and Users
   Copy files from {source}/utils/EAP/teiid-security-roles.properties to {EAP_HOME}/standalone/configuration
                   {source}/utils/EAP/teiid-security-users.properties to {EAP_HOME}/standalone/configuration
    
     cp $APP/utils/EAP/teiid-security-users.properties {EAP_HOME}/standalone/configuration
     cp $APP/utils/EAP/teiid-security-roles.properties {EAP_HOME}/standalone/configuration dv/standalone/configuration

5- Images y Envelopes 
   Copy from {source}/utils/Dashbuilder/images to {EAP_HOME}/standalone/deployments/teiid-dashboard-builder.war/images
   Copy from {source}/utils/Dashbuilder/envelopes to {EAP_HOME}/standalone/deployments/teiid-dashboard-builder.war/envelopes/ZON

   cd {EAP_HOME}/standalone/deployments 
   mv teiid-dashboard-builder.war teiid-dashboard-builder2.war
   mkdir teiid-dashboard-builder.war
   mv teiid-dashboard-builder2.war teiid-dashboard-builder.war
   cd teiid-dashboard-builder.war
   unzip teiid-dashboard-builder2.war

    cp -r $APP/utils/Dashbuilder/images dv/standalone/deployments/teiid-dashboard-builder.war
    cp -r $APP/utils/Dashbuilder/envelopes dv/standalone/deployments/teiid-dashboard-builder.war	

6- Virtual Database 
   Copy from {source}/CustomerVDB.vdb to {EAP_HOME}/standalone/deployments/


7- Copt driver postgreSQL - verify your version number
   Copy from {source}/utils/Postgresql/postgresql-9.2-1003.jdbc4 to {EAP_HOME}/standalone/deployments

   cp {source}/utils//Postgresql/postgresql-9.2-1003.jdbc4.jar dv/standalone/ deployment

8- Portal database 
   Copy from {source}/utils/Dashbuilder/teiid-dashboard to {EAP_HOME}/standalone/data 
   
   cp -r $APP/utils/Dashbuilder/teiid-dashboard/*.* dv/standalone/data

9- Copiar web.xml que tiene incorporando el role "portfolio"
   Copy from {source}/utils/Dashbuilder/roles/web.xml to {EAP_HOME}/standalone/deployments/teiid-dashboard-builder.war/WEB-INF

   cp {source}/utils/Dashbuilder/roles/web.xml dv/standalone/  deployments/teiid-dashboard-builder.war/WEB-INF

10- Create Postresql database:
   psql -f={source}/utils//Postgresql/customer-schema-postgresql.sql



      



